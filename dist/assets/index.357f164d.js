var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,s=(e,t)=>{for(var r in t||(t={}))n.call(t,r)&&l(e,r,t[r]);if(a)for(var r of a(t))o.call(t,r)&&l(e,r,t[r]);return e},i=(e,a)=>t(e,r(a)),c=(e,t)=>{var r={};for(var l in e)n.call(e,l)&&t.indexOf(l)<0&&(r[l]=e[l]);if(null!=e&&a)for(var l of a(e))t.indexOf(l)<0&&o.call(e,l)&&(r[l]=e[l]);return r};import{r as u,R as m,a as p,b as d,B as f,S as g,L as _,c as h,g as y,d as E,e as w}from"./vendor.cff9636d.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const O={},v=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`/${e}`)in O)return;O[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script",a.crossOrigin=""),a.href=e,document.head.appendChild(a),t?new Promise(((e,t)=>{a.addEventListener("load",e),a.addEventListener("error",t)})):void 0}))).then((()=>e())):e()},x="/",b="/login",j="/signup",P=u.exports.createContext(null);function S(e){var t=e,{user:r,children:a}=t,n=c(t,["user","children"]);return m.createElement(p,i(s({},n),{render:({location:e})=>r?a:r?null:m.createElement(d,{to:{pathname:"/login",state:{from:e}}})}))}function I(e){var t=e,{user:r,loggedInPath:a,children:n}=t,o=c(t,["user","loggedInPath","children"]);return m.createElement(p,i(s({},o),{render:({location:e})=>r?r?m.createElement(d,{to:{pathname:a,state:{from:e}}}):null:n}))}const L=u.exports.lazy((()=>v((()=>import("./login.0cf16be4.js")),["assets/login.0cf16be4.js","assets/vendor.cff9636d.js"]))),D=u.exports.lazy((()=>v((()=>import("./signup.12955789.js")),["assets/signup.12955789.js","assets/vendor.cff9636d.js"]))),A=u.exports.lazy((()=>v((()=>import("./profile.a3731c47.js")),["assets/profile.a3731c47.js","assets/vendor.cff9636d.js","assets/apiQuery.bb355e10.js","assets/index.ca75ad2e.js"]))),U=u.exports.lazy((()=>v((()=>import("./dashboard.96c80bf2.js")),["assets/dashboard.96c80bf2.js","assets/dashboard.93315c30.css","assets/vendor.cff9636d.js","assets/index.ca75ad2e.js","assets/apiQuery.bb355e10.js"]))),N=u.exports.lazy((()=>v((()=>import("./all-comments.cbffcb20.js")),["assets/all-comments.cbffcb20.js","assets/vendor.cff9636d.js","assets/apiQuery.bb355e10.js"]))),M=u.exports.lazy((()=>v((()=>import("./not-found.a3201f82.js")),["assets/not-found.a3201f82.js","assets/vendor.cff9636d.js"])));function R(){return m.createElement("div",{className:"flex max-h-screen h-screen justify-center items-center"},m.createElement(_,{type:"TailSpin",color:"#00BFFF",height:200,width:200}))}const T=()=>{const{auth:e}=u.exports.useContext(P);let t=!1;return e.isUserLoggedin()&&(t=!0),m.createElement(f,null,m.createElement(u.exports.Suspense,{fallback:m.createElement(R,null)},m.createElement(g,null,m.createElement(I,{user:t,path:"/login",loggedInPath:"/"},m.createElement(L,null)),m.createElement(p,{exact:!0,path:"/signup",component:D}),m.createElement(p,{path:"/comments/:postId",component:N}),m.createElement(S,{user:t,path:"/",exact:!0},m.createElement(U,null)),m.createElement(S,{user:t,path:"/dashboard",exact:!0},m.createElement(U,null)),m.createElement(S,{user:t,path:"/p/:username"},m.createElement(A,null)),m.createElement(p,{path:"*",component:M}))))};m.Component;const z=()=>{if(localStorage.getItem("user")){let e=JSON.parse(localStorage.getItem("user"));if(e&&Date.now()<e.jwt_expired_at)return e}return!1},V=async(e,t)=>{let{data:{jwt:r,user:{username:a,email:n,id:o,profile_pic:{profile_pic:{url:l}}}}}=await h.post("/auth/local",{identifier:e,password:t}),s={jwt:r,username:a,email:n,id:o,profile_pic:l,jwt_expired_at:y(E(Date.now(),{days:20}))};return localStorage.setItem("user",JSON.stringify(s)),s},$={getUserDetails:z,isUserLoggedin:()=>{if(localStorage.getItem("user")){let e=JSON.parse(localStorage.getItem("user"));if(Date.now()<e.jwt_expired_at)return!0}return!1},logOut:async()=>(localStorage.removeItem("user"),!0),login:async(e,t)=>{let r=null;return r=await V(e,t),r},signUp:async e=>{localStorage.removeItem("user");let{data:{user:{username:t,email:r,id:a},jwt:n}}=await h.post(" /auth/local/register",e),o={jwt:n,username:t,id:a,email:r,jwt_expired_at:y(E(Date.now(),{days:20}))};return localStorage.setItem("user",JSON.stringify(o)),o},getUserLogin:V},k=async e=>(await h.get(`/users/${e}`,{params:{}})).data,C={getAllPosts:async(e=0,t=5)=>(1,(await h.get("/api/posts",{params:{_limit:t,_star:_star}})).data),getMultipleUsers:async e=>{let t=Math.ceil(1),r=await h.get("/users/count",{params:{id_nin:e}});r=r.data,r=Math.floor(r+1);let a=[];for(let o=0;o<r;o++)a.push(o);a=Array.from(a,(function(){return Math.floor(Math.random()*(r-t))+t})),a=[...new Set(a)],a.forEach(((e,t)=>{e===z().id&&a.splice(t,1)}));let n=a.map((e=>h.get(`/users/${e}`)));return console.log(n),a=await Promise.allSettled(n),a=a.map((e=>({id:e.value.data.id,username:e.value.data.username,email:e.value.data.email,profile_pic:e.value.data.profile_pic}))),a},getAUser:k,getAUser:k,getOnePost:async e=>(_start+=1,(await h.get(`/api/posts/${e}`)).data),getCommentsForPost:async(e,t=0,r=5)=>(1,(await h.get("/api/comments",{params:{post:e,_limit:r,_star:_star}})).data),isUserFollowing:async e=>{let t=await h.get("/api/followships/count",{params:{user:z().id,following:e}});return console.log(typeof t.data),t.data}};w.render(m.createElement(m.StrictMode,null,m.createElement(P.Provider,{value:{auth:$,query:C}},m.createElement(T,null))),document.getElementById("root"));export{P as A,x as D,b as L,j as S,v as _};
